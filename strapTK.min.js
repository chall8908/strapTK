/*
 * Strap'd ToolKit v 0.1.0 Copyright 2013 to Chris Hall
 * Under a Creative Commons Attribution-ShareAlike 3.0 Unported License
 */
function Extend(e,t,n){var r;t&&_.has(t,"constructor")?r=t.constructor:r=function(){return e.apply(this,arguments)},_.extend(r,e,n);var i=function(){this.constructor=r};return i.prototype=e.prototype,r.prototype=new i,t&&_.extend(r.prototype,t),r.__super__=e.prototype,r}function Typify(e,t){t=_.extend({},Typify.defaults,t),e.setType=function(e){this.type&&(this.removeClass(this.base+"-"+this.type),delete this.type);if(e){if(!_.include(this.constructor.types,e))throw new RangeError("Invalid type - "+e);this.type=e,this.addClass(this.base+"-"+e)}},e.setDefaultValue.call(e.constructor,t.types,"types"),e.setDefaultValue(t.base,"base"),e.setDefaultValue(t.type,"type"),e.base&&e.addClass(e.base),e.type&&e.setType(e.type)}function Component(e,t){var n=e||{},r=t||{};_.isArray(n)&&(n={children:n});for(attr in n)this[attr]=n[attr];this.initialize(r)}function HorizontalRule(){this.klass="HorizontalRule"}function LineBreak(){this.klass="LineBreak"}function Raw(e){this.text=e.body||e,this.klass="Raw"}var strap=new function(){this.allDraggable=function(e){e===!0?$("body").find("*").attr("draggable","true"):e===!1&&$("body").find("*").removeAttr("draggable")},this.build=function(e){function t(e){var n,r=e.klass,i=e.children;return delete e.klass,delete e.children,n=new window[r](e),i&&_.isArray(i)&&i.length&&_(i).each(function(e){n.add(t(e))}),n}typeof e=="string"&&(e=JSON.parse(e));if(_.isArray(e)){var n=[];return _(e).each(function(e){n.push(t(e))}),n}return t(e)},this.generateSimpleTemplate=function(e){return _.template("<"+e+" <%= rootAttrs %>><%= yield %></"+e+">")}};Typify.defaults={types:[""],base:"",type:""},Component.extend=function(e,t){return Extend(this,e,t)},Component=Component.extend({initialize:function(e){this.setDefaultValue([],"children"),_.each(this.children,function(e){this.checkIfRenderable(e)},this),this.setDefaultValue("","childPrefix","childSuffix"),this.klass=this.constructor.klass},setDefaultValue:function(e){var t=Array.prototype.slice.call(arguments,1),n=_.isArray(e)?"apply":"call";_.each(t,function(t){this.hasOwnProperty(t)||(this[t]=e.constructor[n](this,e))},this)},template:function(e){return e.yield},push:function(e){return this.checkIfRenderable(e),this.children.push(e),this},pop:function(){return this.children.pop()},unshift:function(e){return this.checkIfRenderable(e),this.children.unshift(e),this},shift:function(){return this.children.shift()},insert:function(e,t){return this.checkIfRenderable(e),t?this.children.splice(t,0,e):this.children.push(e),this},get:function(e){switch(typeof e){case"string":return this[e];case"number":return this.children[e]}throw TypeError("index must be a string or number.")},remove:function(e){return e?this.children.splice(e,1)[0]:this.pop()},checkIfRenderable:function(e){if(typeof e.render=="function")return;throw TypeError("Object does not respond to render.")},renderChildren:function(e,t){e||(e=this.childPrefix),t||(t=this.childSuffix);var n="";return _.each(this.children,function(r){n+=e+r.render()+t}),n},render:function(){return this.template({yield:this.renderChildren()})},toString:function(){return this.render()}},{klass:"Component"}),Component.prototype.add=Component.prototype.push;var Viewport=Component.extend({initialize:function(e){Viewport.__super__.initialize.call(this,e),this.setDefaultValue("body","root")},render:function(){return $(this.root).empty().append(this.renderChildren())}},{klass:"Viewport"}),Panel=Component.extend({constructor:function(e,t){typeof e=="string"&&(e={body:e}),Panel.__super__.constructor.apply(this,arguments)},initialize:function(e){Panel.__super__.initialize.call(this,e),this.setDefaultValue([],"classes","attributes"),this.setDefaultValue("","id","body")},addClass:function(){var e=Array.prototype.slice.call(arguments,0);return this.classes=_.union(this.classes,e),this},removeClass:function(){var e=[this.classes].concat(Array.prototype.slice.call(arguments,0));return this.classes=_.without.apply(this,e),this},toggleClass:function(){var e=Array.prototype.slice.call(arguments,0);return _.each(e,function(e){_.include(this.classes,e)?this.removeClass(e):this.addClass(e)},this),this},listClasses:function(){return this.classes.join(" ")},listAttributes:function(){var e=Array.prototype.slice.call(arguments,0).concat(["id"]),t=_.map(e,function(e){return this[e]===""?!1:e+"='"+this[e]+"'"},this),n=this.listClasses();return n!==""&&t.push("class='"+n+"'"),this.attributes.join(" ")+" "+_.compact(t).join(" ")},template:strap.generateSimpleTemplate("div"),render:function(){var e=this.body+this.renderChildren();return this.template({yield:e,rootAttrs:this.listAttributes()})}},{klass:"Panel"}),Div=Panel,AbstractBadge=Panel.extend({initialize:function(e){AbstractBadge.__super__.initialize.call(this,e),Typify(this)},template:strap.generateSimpleTemplate("span")},{klass:"AbstractBadge",types:["success","warning","important","info","inverse"]}),Link=Panel.extend({initialize:function(e){Link.__super__.initialize.call(this,e),this.setDefaultValue("#","href")},listAttributes:function(){return FormSelect.__super__.listAttributes.call(this,"href")},template:strap.generateSimpleTemplate("a")},{klass:"Link"}),List=Panel.extend({initialize:function(e){List.__super__.initialize.call(this,e),this.childPrefix||(this.childPrefix="<li>"),this.childSuffix||(this.childSuffix="</li>")},template:strap.generateSimpleTemplate("ul")},{klass:"List"}),Accordion=Panel.extend({initialize:function(e){Accordion.__super__.initialize.call(this,e),this.addClass("accordion")},renderChildren:function(){var e="";return _.each(this.children,function(t,n){var r=this.id+"-"+n;e+="<div class='accordion-group'><div class='accordion-heading'><a class='accordion-toggle' data-parent='#"+this.id+"' data-toggle='collapse' href='#"+r+"'>"+t.heading+"</a>"+"</div>"+"<div class='accordion-body collapse"+(t.open?" in":"")+"' id='"+r+"'>"+"<div class='accordion-inner'>"+t.render()+"</div>"+"</div>"+"</div>"},this),e}},{klass:"Accordion"}),Alert=Panel.extend({initialize:function(e){Alert.__super__.initialize.call(this,e),this.base="alert",Typify(this)},isBlock:function(e){var t=_.include(this.classes,"alert-block");if(e===!0)t||this.addClass("alert-block");else{if(e!==!1)return t;t&&this.removeClass("alert-block")}},setClosable:function(e){var t=!1,n=-1;_.each(this.children,function(e,r){if(e instanceof CloseButton)return t=!0,n=r,!1}),e===!0||typeof e!="boolean"?(t===!1&&this.unshift(new CloseButton({attributes:["data-dismiss='alert'"]})),this.closable=!0):t&&this.remove(n)}},{klass:"Alert",types:["error","success","info"]}),Badge=AbstractBadge.extend({initialize:function(e){this.base="badge",Badge.__super__.initialize.call(this,e)}},{klass:"Badge"}),Breadcrumbs=Panel.extend({initialize:function(e){Breadcrumbs.__super__.initialize.call(this,e),this.childPrefix||(this.childPrefix="<li>"),this.childSuffix||(this.childSuffix="<span class='divider'>/</span></li>"),this.addClass("breadcrumb")},template:strap.generateSimpleTemplate("ul"),render:function(){var e=Breadcrumbs.__super__.render.call(this).split(this.childSuffix),t=e.pop();return e.join(this.childSuffix)+t}},{klass:"Breadcrumbs"}),Button=Link.extend({initialize:function(e){Button.__super__.initialize.call(this,e),this.attributes.unshift("type='button'"),this.base="btn",Typify(this)}},{klass:"Button",types:["primary","info","success","warning","danger","inverse","link"]}),ButtonGroup=Panel.extend({initialize:function(e){ButtonGroup.__super__.initialize.call(this,e),this.addClass("btn-group")}},{klass:"ButtonGroup"}),ButtonToolbar=Panel.extend({initialize:function(e){ButtonToolbar.__super__.initialize.call(this,e),this.addClass("btn-toolbar")}},{klass:"ButtonToolbar"}),Carousel=Panel.extend({initialize:function(e){Carousel.__super__.initialize.call(this,e),this.setDefaultValue(!0,"controls"),this.setDefaultValue("&lsaquo;","prevSymbol"),this.setDefaultValue("&rsaquo;","nextSymbol"),this.addClass("carousel","slide")},template:_.template("<div <%= rootAttrs %>><% if(controls) { %><ol class='carousel-indicators'><% _(slides).times(function(i){ %><li data-slide-to='<%= i %>' data-target='#<%= rootID %>' <%= i == 0 ? \"classes='active'\" : '' %>></li><% }); %></ol><% } %><div class='carousel-inner'><%= yield %></div><% if(controls) { %><a class='carousel-control left' data-slide='prev' href='#<%= rootID %>'><%= prevSymbol %></a><a class='carousel-control right' data-slide='next' href='#<%= rootID %>'><%= nextSymbol %></a><% } %></div>"),renderChildren:function(){var e="";return _.each(this.children,function(t,n){e+="<div class='item"+(n==0?" active":"")+"'>"+t.render()+"</div>"}),e},render:function(){var e=this.body+this.renderChildren();return this.template({yield:e,rootID:this.id,rootAttrs:this.listAttributes(),controls:this.controls,slides:this.children.length,prevSymbol:this.prevSymbol,nextSymbol:this.nextSymbol})}},{klass:"Carousel"}),CloseButton=Link.extend({initialize:function(e){CloseButton.__super__.initialize.call(this,e),this.addClass("close"),this.body||(this.body="&times;")}},{klass:"CloseButton"}),ContentRow=Panel.extend({initialize:function(e){ContentRow.__super__.initialize.call(this,e),this.setDefaultValue(12,"maxChildren"),this.ensureChildLimit(),this.addClass("row-fluid")},push:function(e){this.ensureChildLimit(),ContentRow.__super__.push.call(this,e)},unshift:function(e){this.ensureChildLimit(),ContentRow.__super__.unshift.call(this,e)},insert:function(e,t){this.ensureChildLimit(),ContentRow.__super__.insert.call(this,e,t)},renderChildren:function(e,t){e||(e=this.childPrefix),t||(t=this.childSuffix);var n=this.maxChildren,r=this.children.length;_.each(this.children,function(e){n-=e.span||0,r-=e.span?1:0});var i=Math.floor(n/r),s="";return _.each(this.children,function(n){s+="<div class='span"+(n.span||i)+"'>"+e+n.render()+t+"</div>"}),s},ensureChildLimit:function(){if(this.children.length>=this.maxChildren)throw TooManyChildrenError("This row can only have "+this.maxChildren+" children")}},{klass:"ContentRow"}),Dropdown=List.extend({initialize:function(e){Dropdown.__super__.initialize.call(this,e),this.childPrefix="<li>",this.childSuffix="</li>",this.addClass("dropdown-menu")}},{klass:"Dropdown"}),Form=Panel.extend({initialize:function(e){Form.__super__.initialize.call(this,e),this.setDefaultValue("GET","method"),this.setDefaultValue("","action")},template:strap.generateSimpleTemplate("form"),listAttributes:function(){return FormSelect.__super__.listAttributes.call(this,"method","action")}},{klass:"Form"}),FormInput=Panel.extend({initialize:function(e){FormInput.__super__.initialize.call(this,e),this.setDefaultValue("","placeholder","name","value"),this.setDefaultValue("text","type"),this.base="input",Typify(this)},template:_.template("<input <%= rootAttrs %> />"),listAttributes:function(){return FormSelect.__super__.listAttributes.call(this,"type","placeholder","name","value")}},{klass:"FormInput",types:["button","checkbox","color","date","datetime","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"]}),FormLabel=Panel.extend({template:strap.generateSimpleTemplate("label")},{klass:"FormLabel"}),FormSelect=Panel.extend({template:strap.generateSimpleTemplate("select")},{klass:"FormSelect"}),HeroUnit=Panel.extend({initialize:function(e){HeroUnit.__super__.initialize.call(this,e),this.setDefaultValue("","title"),this.addClass("hero-unit")},template:_.template("<div <%= rootAttrs %>><h1><%= title %></h1><%= yield %></div>"),render:function(){var e=this.body+this.renderChildren();return this.template({yield:e,title:this.title,rootAttrs:this.listAttributes()})}},{klass:"HeroUnit"});HorizontalRule.prototype.render=function(){return"<hr/>"};var HR=HorizontalRule,Icon=Panel.extend({initialize:function(e){Icon.__super__.initialize.call(this,e),this.base="icon",Typify(this)},template:_.template("<i <%= rootAttrs %>></i> <%= yield %>")},{klass:"Icon",types:["cloud-download","cloud-upload","lightbulb","exchange","bell-alt","file-alt","beer","coffee","food","fighter-jet","user-md","stethoscope","suitcase","building","hospital","ambulance","medkit","h-sign","plus-sign-alt","spinner","angle-left","angle-right","angle-up","angle-down","double-angle-left","double-angle-right","double-angle-up","double-angle-down","circle-blank","circle","desktop","laptop","tablet","mobile-phone","quote-left","quote-right","reply","github-alt","folder-close-alt","folder-open-alt","adjust","asterisk","ban-circle","bar-chart","barcode","beaker","beer","bell","bell-alt","bolt","book","bookmark","bookmark-empty","briefcase","bullhorn","calendar","camera","camera-retro","certificate","check","check-empty","circle","circle-blank","cloud","cloud-download","cloud-upload","coffee","cog","cogs","comment","comment-alt","comments","comments-alt","credit-card","dashboard","desktop","download","download-alt","edit","envelope","envelope-alt","exchange","exclamation-sign","external-link","eye-close","eye-open","facetime-video","fighter-jet","film","filter","fire","flag","folder-close","folder-open","folder-close-alt","folder-open-alt","food","gift","glass","globe","group","hdd","headphones","heart","heart-empty","home","inbox","info-sign","key","leaf","laptop","legal","lemon","lightbulb","lock","unlock","magic","magnet","map-marker","minus","minus-sign","mobile-phone","money","move","music","off","ok","ok-circle","ok-sign","pencil","picture","plane","plus","plus-sign","print","pushpin","qrcode","question-sign","quote-left","quote-right","random","refresh","remove","remove-circle","remove-sign","reorder","reply","resize-horizontal","resize-vertical","retweet","road","rss","screenshot","search","share","share-alt","shopping-cart","signal","signin","signout","sitemap","sort","sort-down","sort-up","spinner","star","star-empty","star-half","tablet","tag","tags","tasks","thumbs-down","thumbs-up","time","tint","trash","trophy","truck","umbrella","upload","upload-alt","user","user-md","volume-off","volume-down","volume-up","warning-sign","wrench","zoom-in","zoom-out","file","file-alt","cut","copy","paste","save","undo","repeat","text-height","text-width","align-left","align-center","align-right","align-justify","indent-left","indent-right","font","bold","italic","strikethrough","underline","link","paper-clip","columns","table","th-large","th","th-list","list","list-ol","list-ul","list-alt","angle-left","angle-right","angle-up","angle-down","arrow-down","arrow-left","arrow-right","arrow-up","caret-down","caret-left","caret-right","caret-up","chevron-down","chevron-left","chevron-right","chevron-up","circle-arrow-down","circle-arrow-left","circle-arrow-right","circle-arrow-up","double-angle-left","double-angle-right","double-angle-up","double-angle-down","hand-down","hand-left","hand-right","hand-up","circle","circle-blank","play-circle","play","pause","stop","step-backward","fast-backward","backward","forward","fast-forward","step-forward","eject","fullscreen","resize-full","resize-small","phone","phone-sign","facebook","facebook-sign","twitter","twitter-sign","github","github-alt","github-sign","linkedin","linkedin-sign","pinterest","pinterest-sign","google-plus","google-plus-sign","sign-blank","ambulance","beaker","h-sign","hospital","medkit","plus-sign-alt","stethoscope","user-md"]}),Image=Panel.extend({initialize:function(e){Image.__super__.initialize.call(this,e),this.setDefaultValue("","src")},template:_.template("<img <%= rootAttrs %> />"),listAttributes:function(){return FormSelect.__super__.listAttributes.call(this,"src")}},{klass:"Image"}),Label=AbstractBadge.extend({initialize:function(e){this.base="label",Label.__super__.initialize.call(this,e)}},{klass:"Label"});LineBreak.prototype.render=function(){return"<br/>"};var BR=LineBreak,Modal=Panel.extend({initialize:function(e){Modal.__super__.initialize.call(this,e),this.setDefaultValue([],"actions"),this.setDefaultValue("","header"),this.addClass("modal")},template:_.template("<div <%= rootAttrs %>><div class='modal-header'><% if(closable) { %><button aria-hidden='true' class='close' data-dismiss='modal' type='button'>&times;</button><% } %><h3><%= header %></h3></div><div class='modal-body'><%= yield%></div><div class='modal-footer'><%= actions %></div></div>"),pushAction:function(e){return this.actions.push(e),this},popAction:function(){return this.actions.pop()},shiftAction:function(e){return this.actions.shift()},unshiftAction:function(e){return this.actions.unshift(e),this},render:function(){var e=this.body,t="";return _.each(this.children,function(t){e+=t.render()}),_.each(this.actions,function(e){t+=e.render()}),this.template({yield:e,header:this.header,actions:t,rootAttrs:this.listAttributes()})}},{klass:"Modal"});Modal.prototype.addAction=Modal.prototype.pushAction;var Nav=List.extend({initialize:function(e){this.childPrefix="<li>",this.childSuffix="</li>",Nav.__super__.initialize.call(this,e),this.setDefaultValue(!1,"divided"),this.base="nav",Typify(this)},renderChildren:function(e,t){e||(e=this.childPrefix),t||(t=this.childSuffix);var n="";return _.each(this.children,function(r){n+=(r.active?e.replace(/>$/," class='active'>"):e)+r.render()+t}),n},render:function(){var e=Nav.__super__.render.call(this);return this.divided&&(e=e.split("</li><li").join("</li><li class='divider-vertical'></li><li")),e},divide:function(e){return e?this.divided=!0:e===!1&&(this.divided=!1),this.divided}},{klass:"Nav",types:["tabs","pills","list"]}),NavBar=Panel.extend({initialize:function(e){NavBar.__super__.initialize.call(this,e),this.addClass("navbar")},renderChildren:function(){return"<div class='navbar-inner'>"+NavBar.__super__.renderChildren.call(this)+"</div>"}},{klass:"NavBar"}),OptGroup=Panel.extend({initialize:function(e){OptGroup.__super__.initialize.call(this,e),this.setDefaultValue("","label")},template:strap.generateSimpleTemplate("optgroup"),listAttributes:function(){return FormSelect.__super__.listAttributes.call(this,"label")}},{klass:"OptGroup"}),PageHeader=Panel.extend({initialize:function(e){PageHeader.__super__.initialize.call(this,e),this.setDefaultValue("","header"),this.setDefaultValue(1,"level")},template:_.template("<div <%= rootAttrs %>><h<%= level %>><%= header%> <small><%= yield%></small></h<%= level %>></div>"),render:function(){var e=this.body+this.renderChildren();return this.template({yield:e,header:this.header,level:this.level,rootAttrs:this.listAttributes()})}},{klass:"PageHeader"}),Pagination=Panel.extend({initialize:function(e){if(this.children&&this.pages)throw new SyntaxError("Paginators cannot accept both children and pages");Pagination.__super__.initialize.call(this,e),this.setDefaultValue(0,"pages"),this.childPrefix="<li>",this.childSuffix="</li>",this.addClass("pagination"),this.children.length===0&&this.buildPages()},renderChildren:function(){return"<ul>"+Pagination.__super__.renderChildren.call(this)+"</ul>"},setPages:function(e){this.pages=e,this.buildPages()},buildPages:function(){this.children=[];if(this.pages<1)throw new SyntaxError("You must supply a number of pages greater than 0");this.pages>1?(this.add(new Link({body:"&laquo;",classes:["prev"]})),_.times(this.pages,function(e){this.add(new Link((e+1).toString()))},this),this.add(new Link({body:"&raquo;",classes:["next"]}))):console.warn("Paginator instanciated with only 1 page.")}},{klass:"Pagination"}),Paragraph=Panel.extend({template:strap.generateSimpleTemplate("p")},{klass:"Paragraph"}),P=Paragraph,ProgressBar=Panel.extend({initialize:function(e){ProgressBar.__super__.initialize.call(this,e),this.setDefaultValue(100,"width"),this.setWidth(this.width),this.base="bar",Typify(this)},setWidth:function(e){if(e>100)throw new RangeError("cannot set width greater than 100%");if(e<0)throw new RangeError("cannot set width less than 0%");var t=this.width;this.width=e,this.attributes=_.reject(this.attributes,function(e){return e.match(/style/i)}).concat(["style='width: "+e+"'"]),t!==e&&$(this).trigger("progressbar.width-change",e,t)}},{klass:"ProgressBar",types:["info","success","warning","danger"]});Raw.prototype.render=function(){return this.text};var SelectOption=Panel.extend({initialize:function(e){SelectOption.__super__.initialize.call(this,e),this.setDefaultValue(this.body,"value")},template:strap.generateSimpleTemplate("option"),listAttributes:function(){return FormSelect.__super__.listAttributes.call(this,"value")}},{klass:"SelectOption"}),Table=Panel.extend({initialize:function(e){Table.__super__.initialize.call(this,e),this.addClass("table"),this.attributes.unshift("style='color: inherit'"),_.each(this.children,this.throwUnlessRow)},push:function(e){this.throwUnlessRow(e),Table.__super__.push.call(this,e)},unshift:function(e){this.throwUnlessRow(e),Table.__super__.unshift.call(this,e)},insert:function(e,t){this.throwUnlessRow(e),Table.__super__.insert.call(this,e,t)},throwUnlessRow:function(e){if(e instanceof TableRow)return;throw new TypeError("Tables can only have Rows as children")},template:strap.generateSimpleTemplate("table")},{klass:"Table"});Table.prototype.add=Table.prototype.push;var TableCell=Panel.extend({template:strap.generateSimpleTemplate("td")},{klass:"TableCell"}),TableHeader=Panel.extend({template:strap.generateSimpleTemplate("th")},{klass:"TableHeader"}),TableRow=Panel.extend({initialize:function(e){TableRow.__super__.initialize.call(this,e),_.each(this.children,this.throwUnlessCell)},push:function(e){this.throwUnlessCell(e),TableRow.__super__.push.call(this,e)},unshift:function(e){this.throwUnlessCell(e),TableRow.__super__.unshift.call(this,e)},insert:function(e,t){this.throwUnlessCell(e),TableRow.__super__.insert.apply(this,arguments)},throwUnlessCell:function(e){if(e instanceof TableCell||e instanceof TableHeader)return;throw new TypeError("Rows can only have Cells as children")},template:strap.generateSimpleTemplate("tr")},{klass:"TableRow"});TableRow.prototype.add=TableRow.prototype.push;var Textarea=Panel.extend({template:strap.generateSimpleTemplate("textarea")},{klass:"Textarea"}),TooManyChildrenError=Extend(Error,{message:"Too many children.",name:"TooManyChildrenError"}),WebsocketConnectError=Extend(Error,{message:"Unable to connect via websocket.",name:"WebsocketConnectError"});